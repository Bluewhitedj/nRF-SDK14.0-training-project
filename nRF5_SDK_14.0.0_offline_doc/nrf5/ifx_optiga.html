<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>nRF5 SDK v14.0.0: Infineon OPTIGA Trust E Command Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet_offline.css" rel="stylesheet" type="text/css"/>
<link href="nordic.css" rel="stylesheet" type="text/css" />
<link rel="Shortcut icon" href="./favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">nRF5 SDK
   &#160;<span id="projectnumber">v14.0.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<table cellspacing="0" cellpadding="0" class="blank">
<tr>
<td class="doclinkintro">Choose documentation:</td>
<td class="doclinks" id="nrf5"><a href="../nrf5/index.html">nRF5 SDK</a></td>
<td class="doclinks" id="s132"><a href="../s132/index.html">S132 SoftDevice API</a></td>
<td class="doclinks" id="s140"><a href="../s140/index.html">S140 SoftDevice API</a></td>
<td class="doclinks" id="s212"><a href="../s212/index.html">S212 SoftDevice API</a></td>
<!--<td class="doclinks" id="s332"><a href="../s332/index.html">S332 SoftDevice API</a></td>-->
</tr>
</table>
<script>
var url=window.location.href.split("/").reverse()[1];
var validLinks= ["nrf5","s132","s140","s212","s332"];
var index;
for (index = 0; index < validLinks.length; ++index) {
   if ( url.indexOf(validLinks[index]) !== -1 ) {
      document.getElementById(validLinks[index]).setAttribute('class', 'doclinks docselected');
   };
};
</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('ifx_optiga.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Infineon OPTIGA Trust E Command Library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="whichnRF nRF52840"><span>This information applies to the <b>nRF52840 SoC</b> only.</span></div><p>The Infineon OPTIGA Trust E Command Library provides a high-level API to access cryptographic and security-related functions of a discrete Infineon OPTIGA Trust E hardware security module connected via I2C. The command library utilizes the <a class="el" href="ifx_i2c.html">Infineon I2C Protocol Stack Library</a> to interface via I2C to the hardware module.</p>
<dl class="section note"><dt>Note</dt><dd>The Infineon OPTIGA Trust E hardware security module must be acquired separately. For more information, visit <a href="https://www.infineon.com/cms/en/product/productType.html?productType=5546d4624f205c9a014f64f24f736ab3" target="_blank">OPTIGA Trust E product website</a>.</dd></dl>
<h1><a class="anchor" id="ifx_optiga_config"></a>
Configuration</h1>
<p>Device-specific configuration related to the Infineon I2C Protocol Stack can be configured in <code>ifx_i2c_config.h</code>.</p>
<h1><a class="anchor" id="ifx_optiga_init"></a>
Library Initialization</h1>
<p>This function initializes the Infineon OPTIGA Trust E device and the host library.</p>
<p>The following code example shows how to initialize the OPTIGA Trust E command library: </p>
<div class="fragment"><div class="line">uint16_t err_code = <a class="code" href="group__ifx__optiga__library.html#ga6b173ebd03b6404099085bcc011edcb5" title="Initialize the Infineon OPTIGA Trust E device and host library.">optiga_open_application</a>();</div>
<div class="line"><span class="keywordflow">if</span> (err_code == <a class="code" href="group__ifx__i2c__config.html#gaa57d97b4e57ba8c0877faba8df7a6cfa" title="Protocol Stack status codes for success.">IFX_I2C_STACK_SUCCESS</a>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Continue with application logic here</span></div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="ifx_optiga_features"></a>
OPTIGA Trust E Commands</h1>
<p>This section explains the most relevant commands supported by the command library.</p>
<dl class="section note"><dt>Note</dt><dd>This documentation and the library implementation cover only a subset of the functions supported by the device.</dd></dl>
<h2><a class="anchor" id="ifx_optiga_features_rng"></a>
Random Number Generation</h2>
<p>The function retrieves a cryptographic-quality random number from the Infineon OPTIGA Trust E device. This function can be used as entropy source for various security schemes. The buffer to store the random number needs to be allocated by the application. The length of the random number ranges from 8 to 256 bytes.</p>
<p>The following code example shows how to retrieve 16 random bytes from an OPTIGA Trust E: </p>
<div class="fragment"><div class="line">uint8_t  rnd[16];</div>
<div class="line">uint16_t err_code = <a class="code" href="group__ifx__optiga__library.html#ga16f507082d1c4343e3ced674eb25ffdf" title="Get a random number.">optiga_get_random</a>(<span class="keyword">sizeof</span>(rnd), rnd);</div>
<div class="line"><span class="keywordflow">if</span> (err_code == <a class="code" href="group__ifx__i2c__config.html#gaa57d97b4e57ba8c0877faba8df7a6cfa" title="Protocol Stack status codes for success.">IFX_I2C_STACK_SUCCESS</a>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Continue with application logic here</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="ifx_optiga_features_certificate"></a>
Device Certificate</h2>
<p>The function retrieves the public X.509 certificate stored in the Infineon OPTIGA Trust E device. The certificate and the contained public key can be used to verify a signature from the device. In addition, the receiver of the certificate can verify the chain of trust by validating the issuer of the certificate and the issuer's signature on the certificate. The buffer to hold the certificate is allocated inside the command library, and is only valid until the next call to the command library.</p>
<p>The following code example shows how to retrieve the device certificate: </p>
<div class="fragment"><div class="line">uint8_t  *certificate;</div>
<div class="line">uint32_t  certificate_len;</div>
<div class="line">uint16_t  err_code = <a class="code" href="group__ifx__optiga__library.html#ga9ff2475c4f9b229e6776f7d86ba01583" title="Get the Infineon OPTIGA Trust E device certificate.">optiga_read_certificate</a>(&amp;certificate, &amp;certificate_len);</div>
<div class="line"><span class="keywordflow">if</span> (err_code == <a class="code" href="group__ifx__i2c__config.html#gaa57d97b4e57ba8c0877faba8df7a6cfa" title="Protocol Stack status codes for success.">IFX_I2C_STACK_SUCCESS</a>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Continue with application logic here</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="ifx_optiga_features_ecdsa"></a>
Digital Signature with ECDSA</h2>
<p>This feature can be used to implement authentication schemes based on the Elliptic Curve Digital Signature Algorithm (ECDSA). Therefore, the function <a class="el" href="group__ifx__optiga__library.html#gacb13072ca643efc83300d7fcbba8e3e4">optiga_sign()</a> creates a signature, using the scheme previously selected with <a class="el" href="group__ifx__optiga__library.html#ga8c305251e4532d9fbafe93a7a66ca1e1">optiga_set_auth_scheme()</a>. The buffer to hold the signature is allocated by the command library, and is only valid until the next call to the command library.</p>
<dl class="section note"><dt>Note</dt><dd>The elliptic curve key length is determined implicitly by the device certificate.</dd></dl>
<p>The following code example shows how to have an ECDSA signature calculated by the Infineon OPTIGA Trust E: </p>
<div class="fragment"><div class="line">uint8_t   authentication_challenge[16] = <span class="comment">/* this challenge is typically supplied by the verifying entity */</span></div>
<div class="line">uint8_t  *signature;</div>
<div class="line">uint32_t  signature_len;</div>
<div class="line">uint16_t  err_code = <a class="code" href="group__ifx__optiga__library.html#ga8c305251e4532d9fbafe93a7a66ca1e1" title="Set the authentication scheme.">optiga_set_auth_scheme</a>();</div>
<div class="line"><span class="keywordflow">if</span> (err_code == <a class="code" href="group__ifx__i2c__config.html#gaa57d97b4e57ba8c0877faba8df7a6cfa" title="Protocol Stack status codes for success.">IFX_I2C_STACK_SUCCESS</a>)</div>
<div class="line">{</div>
<div class="line">    err_code = <a class="code" href="group__ifx__optiga__library.html#gacb13072ca643efc83300d7fcbba8e3e4" title="Sign a message using the OPTIGA device.">optiga_sign</a>(authentication_challenge, <span class="keyword">sizeof</span>(authentication_challenge), &amp;signature, &amp;signature_len);</div>
<div class="line">    <span class="keywordflow">if</span> (err_code == <a class="code" href="group__ifx__i2c__config.html#gaa57d97b4e57ba8c0877faba8df7a6cfa" title="Protocol Stack status codes for success.">IFX_I2C_STACK_SUCCESS</a>)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Continue with application logic here</span></div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Thu Aug 3 2017" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
